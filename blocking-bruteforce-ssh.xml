<ossec_config>
    <active-response>
        <command>firewall-drop</command>
        <location>local</location>
        <rules_id>5710</rules_id>
        <timeout>180</timeout>
    </active-response>
</ossec_config>



<group name="sshd,">
    <rule id="100100" level="10">
      <decoded_as>ssh</decoded_as>
      <description>SSH brute-force attempt detected</description>
      <group>attack</group>
      <options>no_full_log</options>
      <program_name>sshd</program_name>
      <match>Failed password for</match>
      <firedtimes>10</firedtimes>
      <timeframe>3600</timeframe>  <!-- The rule fires if 10 failed logins occur within 1 hour -->
      <active-response>
          <command>python3 /var/ossec/active-response/firewall-drop-specific.py %srcip%</command>
      </active-response>
    </rule>
  </group>